{"ast":null,"code":"import React,{useEffect,useState,useMemo}from\"react\";import{useNavigate}from\"react-router-dom\";import Header from\"../components/Header\";import Charity from\"../components/Charity\";import Gift from\"../components/Gift\";import Footer from\"../components/Footer\";import\"./QuaThuong.css\";import{preloadData}from\"./api\";// Import từ file API\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function QuaThuong(){const[activeTab,setActiveTab]=useState(\"doithuong\");// Tab mặc định\nconst[charityData,setCharityData]=useState([]);// Dữ liệu Quyên góp\nconst[giftData,setGiftData]=useState([]);// Dữ liệu Đổi thưởng\nconst[userData,setUserData]=useState(null);const[loading,setLoading]=useState(true);const navigate=useNavigate();const apiKey=\"oqKbBxKcEn9l4IXE4EqS2sgNzXPFvE\";// Lấy dữ liệu từ sessionStorage hoặc preload\nuseEffect(()=>{const fetchData=async()=>{setLoading(true);const cachedUserData=sessionStorage.getItem(\"userData\");const cachedCharityData=sessionStorage.getItem(\"charityData\");const cachedGiftData=sessionStorage.getItem(\"giftData\");if(cachedUserData&&cachedCharityData&&cachedGiftData){setUserData(JSON.parse(cachedUserData));setCharityData(JSON.parse(cachedCharityData));setGiftData(JSON.parse(cachedGiftData));}else{try{const preload=await preloadData(apiKey,9999);// Gán userId mặc định nếu cần\nsetUserData(preload.userData);setCharityData(preload.charityData);setGiftData(preload.giftData);// Lưu vào sessionStorage\nsessionStorage.setItem(\"userData\",JSON.stringify(preload.userData));sessionStorage.setItem(\"charityData\",JSON.stringify(preload.charityData));sessionStorage.setItem(\"giftData\",JSON.stringify(preload.giftData));}catch(error){console.error(\"Error during preload:\",error);}}setLoading(false);};fetchData();},[apiKey]);// Lọc dữ liệu dựa trên tab\nconst filteredData=useMemo(()=>{if(activeTab===\"tuthien\")return charityData;if(activeTab===\"doithuong\")return giftData;return[];},[activeTab,charityData,giftData]);// Xử lý chuyển tab\nconst handleTabClick=tab=>setActiveTab(tab);// Điều hướng đến trang chi tiết\nconst handleNavigate=(id,dataType)=>{navigate(\"/QuaThuongDetail/\".concat(id,\"?dataType=\").concat(dataType));};if(!userData||loading){return/*#__PURE__*/_jsx(\"p\",{children:\"\\u0110ang t\\u1EA3i d\\u1EEF li\\u1EC7u...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(Header,{walletAC:userData.wallet_AC,userId:userData.userID}),/*#__PURE__*/_jsxs(\"main\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"tab-menu\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn_doithuong \".concat(activeTab===\"doithuong\"?\"active\":\"\"),onClick:()=>handleTabClick(\"doithuong\"),children:\"\\u0110\\xF4\\u0309i th\\u01B0\\u01A1\\u0309ng\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn_tuthien \".concat(activeTab===\"tuthien\"?\"active\":\"\"),onClick:()=>handleTabClick(\"tuthien\"),children:\"Quy\\xEAn go\\u0301p\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"content-container\",children:filteredData.map(item=>{if(activeTab===\"tuthien\"){return/*#__PURE__*/_jsx(\"div\",{onClick:()=>handleNavigate(item.id,item.dataType),children:/*#__PURE__*/_jsx(Charity,{title:item.title,description:item.description,banner:item.banner,charity_target:item.charity_target,charity_status:item.charity_status,charity_title:item.charity_title,top_contributors:item.top_contributors,members:item.total_contributors,status:1,gift_title:item.gift_title,dataType:item.dataType})},item.id);}else if(activeTab===\"doithuong\"){return/*#__PURE__*/_jsx(\"div\",{onClick:()=>handleNavigate(item.id,item.dataType),children:/*#__PURE__*/_jsx(Gift,{title:item.title,description:item.description,banner:item.banner,giftValue:item.giftValue,gift_title:item.gift_title,gift_info:item.gift_info,gift_link:item.gift_link,remaining_gifts:item.remaining_gifts,backgroundColor:item.backgroundColor})},item.id);}else{return null;}})})]}),/*#__PURE__*/_jsx(Footer,{})]});}export default QuaThuong;","map":{"version":3,"names":["React","useEffect","useState","useMemo","useNavigate","Header","Charity","Gift","Footer","preloadData","jsx","_jsx","jsxs","_jsxs","QuaThuong","activeTab","setActiveTab","charityData","setCharityData","giftData","setGiftData","userData","setUserData","loading","setLoading","navigate","apiKey","fetchData","cachedUserData","sessionStorage","getItem","cachedCharityData","cachedGiftData","JSON","parse","preload","setItem","stringify","error","console","filteredData","handleTabClick","tab","handleNavigate","id","dataType","concat","children","className","walletAC","wallet_AC","userId","userID","onClick","map","item","title","description","banner","charity_target","charity_status","charity_title","top_contributors","members","total_contributors","status","gift_title","giftValue","gift_info","gift_link","remaining_gifts","backgroundColor"],"sources":["/Users/hcmhoh02hhul217/Documents/web/webapp-tada/src/pages/QuaThuong.js"],"sourcesContent":["import React, { useEffect, useState, useMemo } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport Header from \"../components/Header\";\nimport Charity from \"../components/Charity\";\nimport Gift from \"../components/Gift\";\nimport Footer from \"../components/Footer\";\nimport \"./QuaThuong.css\";\nimport { preloadData } from \"./api\"; // Import từ file API\n\nfunction QuaThuong() {\n  const [activeTab, setActiveTab] = useState(\"doithuong\"); // Tab mặc định\n  const [charityData, setCharityData] = useState([]); // Dữ liệu Quyên góp\n  const [giftData, setGiftData] = useState([]); // Dữ liệu Đổi thưởng\n  const [userData, setUserData] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n\n  const apiKey = \"oqKbBxKcEn9l4IXE4EqS2sgNzXPFvE\";\n\n  // Lấy dữ liệu từ sessionStorage hoặc preload\n  useEffect(() => {\n    const fetchData = async () => {\n      setLoading(true);\n\n      const cachedUserData = sessionStorage.getItem(\"userData\");\n      const cachedCharityData = sessionStorage.getItem(\"charityData\");\n      const cachedGiftData = sessionStorage.getItem(\"giftData\");\n\n      if (cachedUserData && cachedCharityData && cachedGiftData) {\n        setUserData(JSON.parse(cachedUserData));\n        setCharityData(JSON.parse(cachedCharityData));\n        setGiftData(JSON.parse(cachedGiftData));\n      } else {\n        try {\n          const preload = await preloadData(apiKey, 9999); // Gán userId mặc định nếu cần\n          setUserData(preload.userData);\n          setCharityData(preload.charityData);\n          setGiftData(preload.giftData);\n\n          // Lưu vào sessionStorage\n          sessionStorage.setItem(\"userData\", JSON.stringify(preload.userData));\n          sessionStorage.setItem(\"charityData\", JSON.stringify(preload.charityData));\n          sessionStorage.setItem(\"giftData\", JSON.stringify(preload.giftData));\n        } catch (error) {\n          console.error(\"Error during preload:\", error);\n        }\n      }\n\n      setLoading(false);\n    };\n\n    fetchData();\n  }, [apiKey]);\n\n  // Lọc dữ liệu dựa trên tab\n  const filteredData = useMemo(() => {\n    if (activeTab === \"tuthien\") return charityData;\n    if (activeTab === \"doithuong\") return giftData;\n    return [];\n  }, [activeTab, charityData, giftData]);\n\n  // Xử lý chuyển tab\n  const handleTabClick = (tab) => setActiveTab(tab);\n\n  // Điều hướng đến trang chi tiết\n  const handleNavigate = (id, dataType) => {\n    navigate(`/QuaThuongDetail/${id}?dataType=${dataType}`);\n  };\n\n  if (!userData || loading) {\n    return <p>Đang tải dữ liệu...</p>;\n  }\n\n  return (\n    <div className=\"App\">\n      <Header walletAC={userData.wallet_AC} userId={userData.userID} />\n      <main>\n        {/* Nút chuyển đổi tab */}\n        <div className=\"tab-menu\">\n          <button\n            className={`btn_doithuong ${activeTab === \"doithuong\" ? \"active\" : \"\"}`}\n            onClick={() => handleTabClick(\"doithuong\")}\n          >\n            Đổi thưởng\n          </button>\n          <button\n            className={`btn_tuthien ${activeTab === \"tuthien\" ? \"active\" : \"\"}`}\n            onClick={() => handleTabClick(\"tuthien\")}\n          >\n            Quyên góp\n          </button>\n        </div>\n\n        {/* Hiển thị dữ liệu */}\n        <div className=\"content-container\">\n          {filteredData.map((item) => {\n            if (activeTab === \"tuthien\") {\n              return (\n                <div key={item.id} onClick={() => handleNavigate(item.id, item.dataType)}>\n                  <Charity\n                    title={item.title}\n                    description={item.description}\n                    banner={item.banner}\n                    charity_target={item.charity_target}\n                    charity_status={item.charity_status}\n                    charity_title={item.charity_title}\n                    top_contributors={item.top_contributors}\n                    members={item.total_contributors}\n                    status={1}\n                    gift_title={item.gift_title}\n                    dataType={item.dataType}\n                  />\n                </div>\n              );\n            } else if (activeTab === \"doithuong\") {\n              return (\n                <div key={item.id} onClick={() => handleNavigate(item.id, item.dataType)}>\n                  <Gift\n                    title={item.title}\n                    description={item.description}\n                    banner={item.banner}\n                    giftValue={item.giftValue}\n                    gift_title={item.gift_title}\n                    gift_info={item.gift_info}\n                    gift_link={item.gift_link}\n                    remaining_gifts={item.remaining_gifts}\n                    backgroundColor={item.backgroundColor}\n                  />\n                </div>\n              );\n            } else {\n              return null;\n            }\n          })}\n        </div>\n      </main>\n      <Footer />\n    </div>\n  );\n}\n\nexport default QuaThuong;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
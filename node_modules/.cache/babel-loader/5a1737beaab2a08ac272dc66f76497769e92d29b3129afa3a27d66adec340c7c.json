{"ast":null,"code":"import React,{useEffect,useState,useMemo}from\"react\";import{useNavigate}from\"react-router-dom\";import{motion,AnimatePresence}from\"framer-motion\";import Header from\"../components/Header\";import QuizCard from\"../components/QuizCard\";import Footer from\"../components/Footer\";import{preloadData}from\"./api\";import\"./DauTruong.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function DauTruong(){const[activeTab,setActiveTab]=useState(\"Đấu AC\");const[quizData,setQuizData]=useState([]);const[userData,setUserData]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const navigate=useNavigate();const apiKey=\"oqKbBxKcEn9l4IXE4EqS2sgNzXPFvE\";useEffect(()=>{const fetchData=async()=>{const cachedQuizData=sessionStorage.getItem(\"quizData\");const cachedUserData=sessionStorage.getItem(\"userData\");if(cachedQuizData&&cachedUserData){setQuizData(JSON.parse(cachedQuizData));setUserData(JSON.parse(cachedUserData));setLoading(false);}else{try{const preload=await preloadData(apiKey,9999);setQuizData(preload.quizData);setUserData(preload.userData);sessionStorage.setItem(\"quizData\",JSON.stringify(preload.quizData));sessionStorage.setItem(\"userData\",JSON.stringify(preload.userData));}catch(err){setError(\"Failed to load data\");}finally{setLoading(false);}}};fetchData();},[apiKey]);const quizStatusMap=useMemo(()=>{var _userData$quiz_rank;return new Map((userData===null||userData===void 0?void 0:(_userData$quiz_rank=userData.quiz_rank)===null||_userData$quiz_rank===void 0?void 0:_userData$quiz_rank.map(done=>[done.quizID,true]))||[]);},[userData]);const filteredQuizzes=quizData.filter(quiz=>quiz.dataType===activeTab);const handleTabClick=tab=>{setActiveTab(tab);};const handleNewsClick=(id,dataType)=>{navigate(\"/quiz/\".concat(id,\"?dataType=\").concat(dataType));};if(loading){return/*#__PURE__*/_jsx(\"p\",{children:\"\\u0110ang t\\u1EA3i d\\u1EEF li\\u1EC7u...\"});}if(error){return/*#__PURE__*/_jsxs(\"p\",{style:{color:\"red\"},children:[\"L\\u1ED7i: \",error]});}const tabVariants={initial:direction=>({x:direction>0?\"100%\":\"-100%\",// Tab mới bắt đầu ngoài màn hình\nposition:\"absolute\"// Đảm bảo tab nằm đè lên tab cũ\n}),animate:{x:0,// Tab mới trượt vào vị trí trung tâm\nposition:\"relative\",// Đưa tab mới về vị trí bình thường sau khi chuyển đổi\ntransition:{duration:0.5,ease:\"easeInOut\"}},exit:direction=>({x:direction<0?\"100%\":\"-100%\",// Tab cũ trượt ra khỏi màn hình\nposition:\"absolute\",// Đảm bảo tab cũ không ảnh hưởng tab mới\ntransition:{duration:0.5,ease:\"easeInOut\"}})};const direction=activeTab===\"Đấu AC\"?1:-1;return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(Header,{walletAC:userData.wallet_AC,userId:userData.userID}),/*#__PURE__*/_jsxs(\"main\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"tab-menu\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn_dauac \".concat(activeTab===\"Đấu AC\"?\"active\":\"\"),onClick:()=>handleTabClick(\"Đấu AC\"),children:\"\\u0110\\u1EA5u AC\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn_dauusdt \".concat(activeTab===\"Đấu USDT\"?\"active\":\"\"),onClick:()=>handleTabClick(\"Đấu USDT\"),children:\"\\u0110\\u1EA5u USDT\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"quiz-content\",children:/*#__PURE__*/_jsx(AnimatePresence,{exitBeforeEnter:true,custom:direction,children:/*#__PURE__*/_jsx(motion.div,{custom:direction,variants:tabVariants,initial:\"initial\",animate:\"animate\",exit:\"exit\",className:\"quiz-list\",children:filteredQuizzes.map(quiz=>/*#__PURE__*/_jsx(\"div\",{onClick:()=>handleNewsClick(quiz.id,quiz.dataType),children:/*#__PURE__*/_jsx(QuizCard,{title:quiz.title,description:quiz.description,pic:quiz.banner,prizeValue:quiz.prizeValue,done_at:quiz.done_at,topCompleters:quiz.topCompleters,members:quiz.totalParticipants,status:quizStatusMap.has(quiz.id)?0:1,gift_title:quiz.gift_title})},quiz.id))},activeTab)})})]}),/*#__PURE__*/_jsx(Footer,{})]});}export default DauTruong;","map":{"version":3,"names":["React","useEffect","useState","useMemo","useNavigate","motion","AnimatePresence","Header","QuizCard","Footer","preloadData","jsx","_jsx","jsxs","_jsxs","DauTruong","activeTab","setActiveTab","quizData","setQuizData","userData","setUserData","loading","setLoading","error","setError","navigate","apiKey","fetchData","cachedQuizData","sessionStorage","getItem","cachedUserData","JSON","parse","preload","setItem","stringify","err","quizStatusMap","_userData$quiz_rank","Map","quiz_rank","map","done","quizID","filteredQuizzes","filter","quiz","dataType","handleTabClick","tab","handleNewsClick","id","concat","children","style","color","tabVariants","initial","direction","x","position","animate","transition","duration","ease","exit","className","walletAC","wallet_AC","userId","userID","onClick","exitBeforeEnter","custom","div","variants","title","description","pic","banner","prizeValue","done_at","topCompleters","members","totalParticipants","status","has","gift_title"],"sources":["/Users/hcmhoh02hhul217/Documents/web/webapp-tada/src/pages/DauTruong.js"],"sourcesContent":["import React, { useEffect, useState, useMemo } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport Header from \"../components/Header\";\nimport QuizCard from \"../components/QuizCard\";\nimport Footer from \"../components/Footer\";\nimport { preloadData } from \"./api\";\nimport \"./DauTruong.css\";\n\nfunction DauTruong() {\n  const [activeTab, setActiveTab] = useState(\"Đấu AC\");\n  const [quizData, setQuizData] = useState([]);\n  const [userData, setUserData] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  const navigate = useNavigate();\n  const apiKey = \"oqKbBxKcEn9l4IXE4EqS2sgNzXPFvE\";\n\n  useEffect(() => {\n    const fetchData = async () => {\n      const cachedQuizData = sessionStorage.getItem(\"quizData\");\n      const cachedUserData = sessionStorage.getItem(\"userData\");\n\n      if (cachedQuizData && cachedUserData) {\n        setQuizData(JSON.parse(cachedQuizData));\n        setUserData(JSON.parse(cachedUserData));\n        setLoading(false);\n      } else {\n        try {\n          const preload = await preloadData(apiKey, 9999);\n          setQuizData(preload.quizData);\n          setUserData(preload.userData);\n\n          sessionStorage.setItem(\"quizData\", JSON.stringify(preload.quizData));\n          sessionStorage.setItem(\"userData\", JSON.stringify(preload.userData));\n        } catch (err) {\n          setError(\"Failed to load data\");\n        } finally {\n          setLoading(false);\n        }\n      }\n    };\n\n    fetchData();\n  }, [apiKey]);\n\n  const quizStatusMap = useMemo(\n    () => new Map(userData?.quiz_rank?.map((done) => [done.quizID, true]) || []),\n    [userData]\n  );\n\n  const filteredQuizzes = quizData.filter((quiz) => quiz.dataType === activeTab);\n\n  const handleTabClick = (tab) => {\n    setActiveTab(tab);\n  };\n\n  const handleNewsClick = (id, dataType) => {\n    navigate(`/quiz/${id}?dataType=${dataType}`);\n  };\n\n  if (loading) {\n    return <p>Đang tải dữ liệu...</p>;\n  }\n\n  if (error) {\n    return <p style={{ color: \"red\" }}>Lỗi: {error}</p>;\n  }\n\n  const tabVariants = {\n    initial: (direction) => ({\n      x: direction > 0 ? \"100%\" : \"-100%\", // Tab mới bắt đầu ngoài màn hình\n      position: \"absolute\", // Đảm bảo tab nằm đè lên tab cũ\n    }),\n    animate: {\n      x: 0, // Tab mới trượt vào vị trí trung tâm\n      position: \"relative\", // Đưa tab mới về vị trí bình thường sau khi chuyển đổi\n      transition: { duration: 0.5, ease: \"easeInOut\" },\n    },\n    exit: (direction) => ({\n      x: direction < 0 ? \"100%\" : \"-100%\", // Tab cũ trượt ra khỏi màn hình\n      position: \"absolute\", // Đảm bảo tab cũ không ảnh hưởng tab mới\n      transition: { duration: 0.5, ease: \"easeInOut\" },\n    }),\n  };\n\n  const direction = activeTab === \"Đấu AC\" ? 1 : -1;\n\n  return (\n    <div className=\"App\">\n      <Header walletAC={userData.wallet_AC} userId={userData.userID} />\n      <main>\n        <div className=\"tab-menu\">\n          <button\n            className={`btn_dauac ${activeTab === \"Đấu AC\" ? \"active\" : \"\"}`}\n            onClick={() => handleTabClick(\"Đấu AC\")}\n          >\n            Đấu AC\n          </button>\n          <button\n            className={`btn_dauusdt ${activeTab === \"Đấu USDT\" ? \"active\" : \"\"}`}\n            onClick={() => handleTabClick(\"Đấu USDT\")}\n          >\n            Đấu USDT\n          </button>\n        </div>\n\n        <div className=\"quiz-content\">\n          <AnimatePresence exitBeforeEnter custom={direction}>\n            <motion.div\n              key={activeTab}\n              custom={direction}\n              variants={tabVariants}\n              initial=\"initial\"\n              animate=\"animate\"\n              exit=\"exit\"\n              className=\"quiz-list\"\n            >\n              {filteredQuizzes.map((quiz) => (\n                <div\n                  key={quiz.id}\n                  onClick={() => handleNewsClick(quiz.id, quiz.dataType)}\n                >\n                  <QuizCard\n                    title={quiz.title}\n                    description={quiz.description}\n                    pic={quiz.banner}\n                    prizeValue={quiz.prizeValue}\n                    done_at={quiz.done_at}\n                    topCompleters={quiz.topCompleters}\n                    members={quiz.totalParticipants}\n                    status={quizStatusMap.has(quiz.id) ? 0 : 1}\n                    gift_title={quiz.gift_title}\n                  />\n                </div>\n              ))}\n            </motion.div>\n          </AnimatePresence>\n        </div>\n      </main>\n      <Footer />\n    </div>\n  );\n}\n\nexport default DauTruong;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}